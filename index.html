<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta charset="utf-8" />
    <title>登入-天鉴综合信息化平台</title>
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="stylesheet" href="layuiadmin/layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="layuiadmin/style/admin.css" media="all" />
    <link rel="stylesheet" href="layuiadmin/style/login.css" media="all" />
    <script src="js/vue.min.js"></script>  
    <script src="js/vue-resource.min.js"></script>
</head>
<body>
    <div class="layadmin-user-login layadmin-user-display-show" id="LAY-user-login" style="display: none;">
        <div class="layadmin-user-login-main">
            <div class="layadmin-user-login-box layadmin-user-login-header">
                <h2>天鉴科技</h2>
                <p>综合信息化平台</p>
            </div>
            <div id="userinput" class="layadmin-user-login-box layadmin-user-login-body layui-form">
                <div class="layui-form-item">
                    <label class="layadmin-user-login-icon layui-icon layui-icon-username" for="LAY-user-login-username"></label>
                    <input type="text" name="username" v-model="unm" id="username" lay-verify="required" placeholder="用户名" class="layui-input" />
                </div>
                <div class="layui-form-item">
                    <label class="layadmin-user-login-icon layui-icon layui-icon-password" for="LAY-user-login-password"></label>
                    <input type="password" name="password" v-model="upw" id="userpassword" lay-verify="required" placeholder="密码" class="layui-input" />
                </div>
                <div class="layui-form-item">
                    <div class="layui-row">
                        <div class="layui-col-xs7">
                            <label class="layadmin-user-login-icon layui-icon layui-icon-vercode" for="LAY-user-login-vercode"></label>
                            <input type="text" id="loginvercode" v-model="yzm" lay-verify="required" placeholder="图形验证码" class="layui-input" />
                        </div>
                        <div class="layui-col-xs5">
                            <div style="margin-left: 10px;">
                                <img id="imgyanzhengma" src="yzm/yanzhengma.aspx" alt="点击换一个" title="点击换一个" style="cursor: auto; height: 2.29rem;"  v-on:click="changeImg()" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item" style="margin-bottom: 20px;">
                    <input type="checkbox" name="remember" lay-skin="primary" title="记住密码" />
                </div>
                <div id="login" class="layui-form-item">
                    <!--<button id="btn_ok" v-on:click="checkinput" class="layui-btn layui-btn-fluid">登入</button>-->
                    <input type="submit" id="btn_ok" v-on:click="checkinput" value="登入" style="font-size: 1.3rem;letter-spacing: 1rem;" class="layui-btn layui-btn-fluid" />
                </div>
            </div>
        </div> 
        <div class="layui-trans layadmin-user-login-footer">
            <p>© 2018 <a v-bind:href="url" target="_blank">www.china315net.com</a></p>
        </div>
    </div>
    <input type="hidden"  id="iszc" value="0" />
    <input type="hidden"  id="isshow" value="0" />  
    <script type="text/javascript">
        var vm = new Vue({
            el: '#LAY-user-login',
            data: {
                unm: '',
                upw: '',
                yzm:'',
                url: "http://www.china315net.com" 
            },
            methods: {
                checkinput: function () {
                    if (this.unm.length == 0) {
                        alert('请输入用户名！');
                        return;
                    }
                    if (this.upw.length == 0) {
                        alert('请输入您的密码！');
                        return;
                    }
                    //发送 post 请求
                    this.$http.post('ajax/loginhandle.ashx', { unm: this.unm, upw: this.upw }, { emulateJSON: true }).then(function (res) {
                        console.log(res.data.rs); 
                        if (res.data.rs == 1) {
                            this.go();
                            window.close();
                        } else {
                            alert(res.data.msg);
                        }
                    }, function (res) {
                        alert(res.bodyText); 
                    }); 
                },
                changeImg:function() {
                    window.reload();
                },
                go:function() {
                    window.open("views/index.aspx");
                }
            }
        })
    </script>
</body>
</html>
